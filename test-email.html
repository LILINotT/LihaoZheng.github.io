<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>邮件功能测试</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-form {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .form-group {
            margin-bottom: 20px;
        }
        input, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        button {
            background: #007bff;
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background: #0056b3;
        }
        .info {
            background: #e7f3ff;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="test-form">
        <h1>邮件功能测试</h1>
        
        <div class="info">
            <strong>测试说明：</strong><br>
            1. 填写下面的表单<br>
            2. 点击"发送测试邮件"<br>
            3. 系统会打开邮件客户端，发送邮件到 lihao.zheng.kg@gmail.com<br>
            4. 同时会为访客准备自动回复邮件
        </div>
        
        <form id="test-form">
            <div class="form-group">
                <input type="text" name="name" id="test-name" placeholder="您的名字" required>
            </div>
            <div class="form-group">
                <input type="email" name="email" id="test-email" placeholder="您的邮箱" required>
            </div>
            <div class="form-group">
                <textarea name="message" id="test-message" placeholder="测试消息内容" rows="5" required></textarea>
            </div>
            <button type="submit">发送测试邮件</button>
        </form>
    </div>

    <script>
        // 测试邮件发送功能
        document.getElementById('test-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const formObject = {};
            formData.forEach((value, key) => {
                formObject[key] = value;
            });
            
            // 调用邮件发送函数
            sendToGmailDirectly(formObject);
        });
        
        // 直接发送到Gmail
        function sendToGmailDirectly(formData) {
            const { name, email, message } = formData;
            
            // 创建邮件内容
            const subject = `来自个人网站的新消息 - ${name}`;
            const body = `您收到一条来自个人网站的新消息：

发件人：${name}
邮箱：${email}

消息内容：
${message}

---
此邮件由个人网站自动生成
时间：${new Date().toLocaleString('zh-CN')}`;
            
            // 创建mailto链接
            const mailtoLink = `mailto:lihao.zheng.kg@gmail.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
            
            // 显示成功消息
            alert('✅ 邮件已准备完成！请在弹出的邮件客户端中点击"发送"按钮。');
            
            // 打开邮件客户端
            setTimeout(() => {
                window.open(mailtoLink);
            }, 500);
            
            // 发送自动回复给访客
            sendAutoReplyToVisitor(name, email);
        }
        
        // 发送自动回复给访客
        function sendAutoReplyToVisitor(visitorName, visitorEmail) {
            if (visitorEmail && visitorName) {
                const autoReplySubject = '感谢您的留言 - 郑力浩';
                const autoReplyBody = `您好 ${visitorName}！

感谢您通过我的个人网站联系我。我已经收到您的消息，会尽快回复您。

此邮件为自动回复，请勿直接回复。

祝好！
郑力浩
Envision Energy - PMO
邮箱：lihao.zheng.kg@gmail.com
电话：+86 15267138751`;
                
                // 创建自动回复的mailto链接
                const autoReplyLink = `mailto:${visitorEmail}?subject=${encodeURIComponent(autoReplySubject)}&body=${encodeURIComponent(autoReplyBody)}`;
                
                // 延迟打开自动回复邮件
                setTimeout(() => {
                    window.open(autoReplyLink);
                }, 2000);
                
                console.log('自动回复邮件已准备发送给访客');
            }
        }
    </script>
</body>
</html>
